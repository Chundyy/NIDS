from fastapi import APIRouter
from db import get_connection
from typing import Dict

router = APIRouter()

@router.get("/")
def get_reports():
    conn = get_connection()
    cur = conn.cursor()
    cur.execute("SELECT id, sample_name, sha256, iocs FROM malware_reports;")
    rows = cur.fetchall()
    conn.close()

    reports = []
    for row in rows:
        reports.append({
            "id": row[0],
            "sample_name": row[1],
            "sha256": row[2],
            "iocs": row[3]
        })
    return reports
